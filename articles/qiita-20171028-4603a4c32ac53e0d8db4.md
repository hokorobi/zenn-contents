---
title: "ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ChangeLogã£ã½ã„å½¢å¼ã§Spreadsheetã«è¨˜éŒ²ã™ã‚‹"
emoji: "ğŸ˜€"
type: "tech"
topics: [Twitter,GoogleAppsScript,IFTTT,GoogleSpreadSheet]
published: false
published_at: 2017-10-28 14:38
---

ä¸€æ—¥åˆ†ã®ãƒ„ã‚¤ãƒ¼ãƒˆã‚’1ã‚¨ãƒ³ãƒˆãƒªï¼ˆï¼Ÿï¼‰ã«ã¾ã¨ã‚ã¦ ChangeLog ã£ã½ã„å½¢å¼ã§Spradsheetã«ä¿å­˜ã™ã‚‹ã€‚

```
2017-10-28 (åœŸ)

* tweet [Diary]:

00:00 hoge
01:15 fuga
02:30 MT @name @h0k0r0bi hogefuga
03:45 FV fugahoge
```

# è¨˜éŒ²

IFTTT ã§è‡ªåˆ†ã®ãƒ„ã‚¤ãƒ¼ãƒˆã€ãƒªãƒ—ãƒ©ã‚¤ã€ãƒ©ã‚¤ã‚¯ã‚’ spreadsheet ã«è¨˜éŒ²

- Trriger
    - Twitter
       - New Tweet by you (retweets, @replies)
       - New mention of you
       - New liked tweet by you

- Action
  ãƒˆãƒªã‚¬ãƒ¼ãã‚Œãã‚Œã«å¯¾ã—ã¦è¨­å®š

    - Google drive
        - Add row to spreadsheet

# æ•´å½¢

GAS ã§æ•´å½¢ã€‚

- inputFormula(): ãƒ„ã‚¤ãƒ¼ãƒˆã®å…ˆé ­ã«æ™‚é–“ã‚’ä»˜åŠ ã™ã‚‹å½¢å¼ã«ãªã‚‹å¼ã‚’3åˆ—ç›®ã«è¿½åŠ 
- copyTweets(): åˆ¥ã‚·ãƒ¼ãƒˆã«3åˆ—ç›®ã‚’ã‚³ãƒ”ãƒ¼
- clearSheet(): è¨˜éŒ²ã‚·ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢
- inputDate(): æ—¥ä»˜ã¨ã‚¨ãƒ³ãƒˆãƒªã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’3åˆ—ç›®ã«è¿½åŠ 

```js
function executePerDay() {
  inputFormula();
  copyTweets();
  clearSheet('Sheet1');
  inputDate();
}

function inputDate() {
  var sheet = SpreadsheetApp.getActive().getSheetByName('Sheet1');
  var d = new Date();
  var year = d.getFullYear();
  var month = d.getMonth() + 1;
  var day = d.getDate();
  var youbi = d.getDay();
  var youbis = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
  sheet.appendRow(["", "Sep"]);
  sheet.appendRow(["", "", year + "-" + month + "-" + day + " (" + youbis[youbi] + ")"]);
  sheet.appendRow(["", "Sep"]);
  sheet.appendRow(["", "", "* tweet [Diary]:"]);
  sheet.appendRow(["", "Sep"]);
}

function inputFormula() {
  var sheet = SpreadsheetApp.getActive().getSheetByName('Sheet1');
  var lastRow = sheet.getLastRow();
  var range;
  for (var i = 1; i <= lastRow; i++) {
    range = sheet.getRange(i, 1);
    if (range.getValue() == "") {
      continue;
    }
    range = sheet.getRange(i, 3);
    if (range.getValue() == "") {
      range.setValue("=text(value((REGEXEXTRACT(A" + i + ",\"[^ ]+$\"))),\"HH:mm \") & B" + i);
    }
  }
}

function copyTweets() {
  var fromSheet = SpreadsheetApp.getActive().getSheetByName('Sheet1');
  var lastRow = fromSheet.getLastRow();
  var fromRange = fromSheet.getRange(1, 3, lastRow);
  var values = fromRange.getValues();
  
  var toSheet = SpreadsheetApp.getActive().getSheetByName('Sheet2');
  var toLastRow = toSheet.getLastRow();
  var toRange = toSheet.getRange(toLastRow + 2, 1, lastRow);
  toRange.setValues(values);
}

function clearSheet(sheetName) {
  var sheet = SpreadsheetApp.getActive().getSheetByName(sheetName);
  sheet.clearContents();
}
```

# æ•´å½¢ã®å®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼

1æ—¥1å›0æ™‚ãã‚‰ã„ã«å®Ÿè¡Œã€‚

![image](https://qiita-image-store.s3.amazonaws.com/0/24711/fb139f76-6774-595c-adc6-19f9408b87db.png)


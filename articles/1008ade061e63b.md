---
title: "CtrlPã§é¸æŠã—ãŸãƒ‘ã‚¹ã‚’æŒ¿å…¥"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Vim"]
published: true
---

:::message
ã“ã®è¨˜äº‹ã¯[Vim Advent Calendar 2021](https://qiita.com/advent-calendar/2021/vim)ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼2ã®20æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚
:::

Sphinx ã§ç¤¾å†…ã«å…¬é–‹ã—ã¦ã„ã‚‹Webãƒšãƒ¼ã‚¸ã«æ²è¼‰ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã„ã¦ã„ã¾ã™ãŒç”»åƒã®ãƒ‘ã‚¹å…¥åŠ›ãŒã¡ã‚‡ã£ã¨ãƒ¡ãƒ³ãƒ‰ã‚¯ã‚µã‚¤ã€‚

ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯ ```_image``` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«ã‚ã‚‹ã®ã§ã€ [CtrlP](https://github.com/ctrlpvim/ctrlp.vim) ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ãŸã‚‰æŒ¿å…¥ã—ã¦ãã‚Œã‚‹ã¨ã„ã„ã®ã«ã¨æ€ã„èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚
```g:ctrlp_open_func``` ã§ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã”ã¨ã«å®Ÿè¡Œã™ã‚‹é–¢æ•°ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã§ã™ã€‚
ä¸€æ™‚çš„ã« ```:CtrlP``` ã‚’å®Ÿè¡Œã—ã¦é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã€ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä»˜ã‘ã¦ãƒ‘ã‚¹ã‚’æŒ¿å…¥ã™ã‚‹å‡¦ç†ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚

```~/vimfiles/autoload/vimrc.vim``` ã¸ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
```call vimrc#CtrlPFilenameInsert('.. image:: ', '')``` ã¨å®Ÿè¡Œã—ã¦ _image/img.png ã‚’é¸æŠã™ã‚‹ã¨ ```.. image:: _image/img.png``` ã¨ã„ã£ãŸå†…å®¹ãŒãƒãƒƒãƒ•ã‚¡ã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚


```vim:~/vimfiles/autoload/vimrc.vim æŠœç²‹
" CtrlP ã§é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒãƒ•ã‚¡ã«æŒ¿å…¥
function! vimrc#CtrlPPasteFunc(action, line) abort
  call setreg('9', getreg('7') .. a:line .. getreg('8'))
  call ctrlp#exit()
  normal! "zp
  call setreg('7', s:backreg7)
  call setreg('8', s:backreg8)
  call setreg('9', s:backreg9)
  let g:ctrlp_open_func = {}
endfunction
function! vimrc#CtrlPFilenameInsert(prefix, suffix) abort
  let s:backreg7 = getreg('7')
  let s:backreg8 = getreg('8')
  let s:backreg9 = getreg('9')
  call setreg('7', a:prefix)
  call setreg('8', a:suffix)
  let g:ctrlp_open_func = { 'files': 'vimrc#CtrlPPasteFunc' }
  CtrlP
  " ã“ã“ã§ setreg('7', backreg7) ãªã©ã¨æ›¸ã„ã¦ã‚‚é§„ç›®ã€‚
  " CtrlP ãŒéåŒæœŸã§å‹•ããŸã‚å…ˆã«ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ãŒå…ƒã«æˆ»ã£ã¦ã—ã¾ã†ã€‚
endfunction
```

## ç’°å¢ƒ
OS: Windows10  
Vim: gVim [Release v8.2.3848](https://github.com/vim/vim-win32-installer/releases/tag/v8.2.3848)  
[ctrlpvim/ctrlp.vim at fc153aabd54f9189e576c9bfb07bac09f36f2ccd](https://github.com/ctrlpvim/ctrlp.vim/tree/fc153aabd54f9189e576c9bfb07bac09f36f2ccd)


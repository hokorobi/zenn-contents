---
title: "ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®URLã‹ã‚‰URLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ppx"]
published: true
---

ã‚¿ã‚¤ãƒˆãƒ«ã®é€šã‚Šã€‚

```javascript:script/pasteUrl.js9
//!*script
// ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®URLã‹ã‚‰URLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚
// PPx 1.84+1 x64 + Script Module R18

// ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«URLãŒå…¥ã£ã¦ã„ãªã‹ã£ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦çµ‚äº†
var url = PPx.Extract('%*clippedtext()');
if (!url.match(/^(file|ftp|http):/i)) {
  linemessage('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«URLãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
  PPx.Quit(-1);
}

// ãƒ•ã‚¡ã‚¤ãƒ«åãŒé‡è¤‡ã—ã¦ã„ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦çµ‚äº†
var filename = PPx.Arguments.Item(0);
var fso = new ActiveXObject('Scripting.FileSystemObject');
if (fso.FileExists(filename)) {
  linemessage('åŒåã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¦ã„ã¾ã™ã€‚: ' + filename);
  PPx.Quit(-1);
}

// URLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
var prefix = "[InternetShortcut]\nURL=";
var content = prefix + url;

var fw = fso.CreateTextFile(filename, false);
fw.WriteLine(content);
fw.Close();

function linemessage(message) {
    var basename = PPx.ScriptName.split(/[\\/]/).pop();
    PPx.Execute('*execute C,*logwindow "' + basename + ': ' + message + '"');
}
```

Alt+K ã«ç™»éŒ²ã€‚

```:PPx.CFG
KC_main	= {
&K	,*script %0script\pasteUrl.js9,%*input(".url" -title:"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®URLã‹ã‚‰URLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ" -select:t)
}
```


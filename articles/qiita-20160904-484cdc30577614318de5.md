---
title: "Vim ã® grep ã‚’ pt (The Platinum Searcher) ã§å®Ÿè¡Œã—ã¦ QuickFix ã‚’ãƒ•ã‚¡ã‚¤ãƒ«"
emoji: "ğŸ˜€"
type: "tech"
topics: [Vim]
published: false
published_at: 2016-09-04 17:10
---

vimrc ã«ä»¥ä¸‹ã‚’è¨˜è¿°ã™ã‚‹ã€‚

```vim
augroup vimrc
  autocmd!
augroup END

" grep ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã« pt ã‚’æŒ‡å®š
let &grepprg = 'pt /nogroup /nocolor /column /S'
" /column ã§æ¡ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã®ã§ %c ã‚‚ä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¿½åŠ 
set grepformat^=%f:%l:%c:%m
" grep å¾Œã« quickfix-window ã‚’è¡¨ç¤º
autocmd vimrc QuickFixCmdPost *grep* cwindow

" http://stackoverflow.com/questions/15393301/automatically-sort-quickfix-entries-by-line-text-in-vim
" pt ã§ grep ã‚’å®Ÿè¡Œã—ãŸå¾Œã«çµæœã‚’ãƒ‘ã‚¹é †ã«ã—ãŸã‹ã£ãŸã®ã§ sort
autocmd! vimrc QuickFixCmdPost * call s:SortQuickfix('s:QfStrCmp')
function! s:SortQuickfix(fn)
  call setqflist(sort(getqflist(), a:fn))
endfunction
function! s:QfStrCmp(e1, e2)
  let [t1, t2] = [bufname(a:e1.bufnr), bufname(a:e2.bufnr)]
  return t1 <? t2 ? -1 : t1 ==? t2 ? 0 : 1
endfunction
```

